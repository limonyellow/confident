{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Confident","text":"<p>Confident helps you create configuration objects from multiple sources such as files, environment variables and maps. Confident's <code>BaseConfig</code> class is a data model that enforces validation and type hints by using pydantic library.</p> <p>With Confident you can manage multiple configurations depending on the environment your code is deployed in. While having lots of flexibility in how to describe your config objects, Confident will provide visibility of the process and help you expose misconfiguration as soon as possible.</p>"},{"location":"#example","title":"Example","text":"<pre><code>import os\n\nfrom confident import BaseConfig\n\n\n# Creating your own config class by inheriting from `BaseConfig`.\nclass MyAppConfig(BaseConfig):\n    port: int = 5000\n    host: str = 'localhost'\n    labels: list\n\n\n# Illustrates some environment variables.\nos.environ['host'] = '127.0.0.1'\nos.environ['labels'] = '[\"FOO\", \"BAR\"]'  # JSON strings can be used for more types.\n\n# Creating the config object. `BaseConfig` will load the values of the properties.\nconfig = MyAppConfig()\n\nprint(config.host)\n# &gt; 127.0.0.1\nprint(config.model_dump_json())\n# &gt; {\"port\":5000,\"host\":\"127.0.0.1\",\"labels\":[\"FOO\",\"BAR\"]}\nprint(config)\n# &gt; port=5000 host='127.0.0.1' labels=['FOO', 'BAR']\nprint(config.full_fields())\n# &gt; {\n# 'port': ConfigField(name='port', value=5000, origin_value=5000, source_name='MyAppConfig', source_type='class_default', source_location=PosixPath('~/confident/readme_example.py')),\n# 'host': ConfigField(name='host', value='127.0.0.1', origin_value='127.0.0.1', source_name='host', source_type='env_var', source_location='host'),\n# 'labels': ConfigField(name='labels', value=['FOO', 'BAR'], origin_value='[\"FOO\", \"BAR\"]', source_name='labels', source_type='env_var', source_location='labels')\n# }\n\n</code></pre>"},{"location":"#installation","title":"Installation","text":"<pre><code>pip install confident\n</code></pre>"},{"location":"#capabilities","title":"Capabilities","text":""},{"location":"#customized-fields-loaders","title":"Customized Fields Loaders","text":"<p>Built-in loaders:</p> <ul> <li>Environment variables.</li> <li>Config files such as 'json' and 'yaml'.</li> <li>Config maps to load fields depending on the environment. (See documentation)</li> </ul> <p>It is possible to configure the loading priority and add your own loader classes.</p>"},{"location":"#full-support-of-pydantic-basesettings","title":"Full Support of Pydantic BaseSettings","text":"<p>Confident core functionality is based on pydantic library. That means <code>BaseConfig</code> object has all the benefits of pydantic's <code>BaseModel</code> and <code>BaseSettings</code> including type validation, object serialization and many more features.</p>"},{"location":"#config-loading-visibility","title":"Config Loading Visibility","text":"<p><code>BaseConfig</code> object stores details about the fields loading process and offers ways to understand the source of each loaded field. Details about the origin value (before conversion), the location of the source and the type of loader, can all be accessed from the object.</p>"},{"location":"#examples","title":"Examples","text":"<p>More examples can be found in the project's repository.</p>"},{"location":"#contributing","title":"Contributing","text":"<p>To contribute to Confident, please make sure any new features or changes to existing functionality include test coverage.</p>"},{"location":"config_class/","title":"BaseConfig Settings","text":""},{"location":"config_class/#model-config","title":"Model Config","text":"<p>In addition to defining the object's behaviour by inserting key-value arguments, it is possible to change class behaviour using the <code>model_config</code> dictionary with <code>ConfidentConfigDict</code>. This configuration method is similar to pydantic's <code>model_config</code>.</p> <pre><code>from confident import BaseConfig\nfrom confident.config_dict import ConfidentConfigDict\n\nclass MyConfig(BaseConfig):\n    model_config = ConfidentConfigDict(\n        files=['app_config/config1.json', 'app_config/config2.yaml'],\n        ignore_missing_files=True,\n    )\n\n    title: str\n    port: int = 5000\n    retry: bool = False\n</code></pre> <p>This is equivalent to using the <code>from_sources</code> classmethod:</p> <pre><code>from confident import BaseConfig\n\nclass MyConfig(BaseConfig):\n    title: str\n    port: int = 5000\n    retry: bool = False\n\nconfig = MyConfig.from_sources(\n    files=['app_config/config1.json', 'app_config/config2.yaml'],\n    ignore_missing_files=True,\n)\n</code></pre>"},{"location":"config_class/#changing-the-loading-priority","title":"Changing The Loading Priority","text":"<p>It is possible to change the loading order of fields from different sources. If a field value is present in multiple sources, the value from the highest priority source will be chosen and override the others. <code>source_priority</code> is an attribute that holds a list of <code>ConfigSource</code> - The first will have the highest priority and the last will have the lowest. Sources whose enum does not appear in the <code>source_priority</code> list will not be loaded to the created object.</p> <pre><code>from confident import BaseConfig, ConfigSource\nfrom confident.config_dict import ConfidentConfigDict\n\nclass MyConfig(BaseConfig):\n    model_config = ConfidentConfigDict(\n        # Here we define that environment vars will have the highest priority (even before explicit values).\n        # Values from files and config maps will have lower priority than default values.\n        source_priority=[\n            ConfigSource.env_var, ConfigSource.init, ConfigSource.class_default, ConfigSource.map, ConfigSource.file\n        ],\n    )\n\n    host: str\n    port: int = 5000\n</code></pre>"},{"location":"deployment_config/","title":"Config Maps","text":"<p>Config maps in Confident is basically a dictionary of configuration values. Only one configuration will be loaded at execution time depending on a given <code>map_name</code>. Config maps can be either a Python dict or a file (json or yaml).</p> <pre><code>multi_configs = {\n                    'prod': {\n                        'host': 'https://prod_server',\n                        'log_level': 'info'\n                    },\n                    'dev': {\n                        'host': 'http://dev_server',\n                        'log_level': 'debug'\n                    },\n                    'local': {\n                        'host': 'localhost',\n                        'log_level': 'debug'\n                    },\n}\n</code></pre> <p>app/configs.json</p> <pre><code>{\n    \"prod\": {\n        \"host\": \"https://prod_server\",\n        \"log_level\": \"info\"\n    },\n    \"dev\": {\n        \"host\": \"http://dev_server\",\n        \"log_level\": \"debug\"\n    },\n    \"local\": {\n        \"host\": \"localhost\",\n        \"log_level\": \"debug\"\n    }\n}\n</code></pre> <p>The BaseConfig class definition can be as follows:</p> <pre><code>from confident import BaseConfig\n\nclass MainConfig(BaseConfig):\n    host: str\n    port: int = 5000\n    log_level: str = 'error'\n</code></pre> <p>Now we can create the config object in several ways:</p> <pre><code># Using python dict:\nconfig_a = MainConfig.from_map(config_map=multi_configs, map_name='local')\nprint(config_a)\n\n#&gt; host='localhost' port=5000 log_level='debug'\n\n# Same, but from a file path:\nconfig_b = MainConfig.from_map(config_map='app/configs.json', map_name='local')\nprint(config_b)\n\n#&gt; host='localhost' port=5000 log_level='debug'\n</code></pre> <p>You can also use <code>from_sources</code> to combine a config map with other sources:</p> <pre><code>config_c = MainConfig.from_sources(\n    config_map='app/configs.json',\n    map_name='local',\n    files='app/overrides.yaml',\n)\nprint(config_c)\n\n#&gt; host='localhost' port=5000 log_level='debug'\n</code></pre>"},{"location":"deployment_config/#map-field","title":"Map Field","text":"<p>If we want more flexibility in selecting the map to load, we can use a property to do so. <code>map_field</code> is a field declared in the config object whose value will define what the <code>map_name</code> is.</p>"},{"location":"deployment_config/#declaration-with-mapfield","title":"Declaration with <code>MapField</code>","text":"<p>The simplest way to declare a map field is to use <code>MapField</code> as the field's default value:</p> <pre><code>from confident import BaseConfig, MapField\n\nclass MainConfig(BaseConfig):\n    my_map: str = MapField('local')  # &lt;-- This will be our `map_field`.\n    host: str\n    port: int = 5000\n    log_level: str = 'error'\n</code></pre>"},{"location":"deployment_config/#declaration-with-model_config","title":"Declaration with <code>model_config</code>","text":"<p>Alternatively, you can use <code>model_config</code> to specify which field is the map field:</p> <pre><code>from confident import BaseConfig\nfrom confident.config_dict import ConfidentConfigDict\n\nclass MainConfig(BaseConfig):\n    model_config = ConfidentConfigDict(\n        map_field='my_map',\n    )\n\n    my_map: str = 'local'\n    host: str\n    port: int = 5000\n    log_level: str = 'error'\n</code></pre>"},{"location":"deployment_config/#usage","title":"Usage","text":"<p>Usage is the same in both ways:</p> <pre><code>config_a = MainConfig.from_map(config_map=multi_configs)\nprint(config_a)\n\n#&gt; my_map='local' host='localhost' port=5000 log_level='debug'\n</code></pre> <p>Notice that the <code>map_field</code>, like every other field, can be loaded from any source:</p> <pre><code>import os\n\nos.environ['my_map'] = 'dev'  # Setting the field as an environment variable.\nconfig_b = MainConfig.from_map(config_map='app/configs.json')\nprint(config_b)\n\n#&gt; my_map='dev' host='http://dev_server' port=5000 log_level='debug'\n</code></pre> <p>By setting <code>my_map</code> via an environment variable, the matching configuration (<code>dev</code>) is loaded from the config map.</p>"},{"location":"usage/","title":"Basic Usage","text":""},{"location":"usage/#load-environment-variables","title":"Load Environment Variables","text":"<p>Simply create an object. Confident will load the property value from an environment variable with the same name if it exists.</p> <pre><code>import os\n\nfrom confident import BaseConfig\n\n\nos.environ['port'] = '3000'\n\nclass MyConfig(BaseConfig):\n    port: int\n\nconfig = MyConfig()\n\nprint(config)\n\n#&gt; port=3000\n</code></pre>"},{"location":"usage/#load-default-values","title":"Load Default Values","text":"<p>Like in <code>dataclass</code> and <code>pydantic</code> classes, it is possible to declare default values of properties.</p> <pre><code>from confident import BaseConfig\n\n\nclass MyConfig(BaseConfig):\n    port: int = 3333\n\nconfig = MyConfig()\n\nprint(config)\n\n#&gt; port=3333\n</code></pre>"},{"location":"usage/#load-config-files","title":"Load Config Files","text":"<p>Confident supports <code>json</code>, <code>yaml</code> and <code>.env</code> files.</p> <p>app_config/config1.json</p> <pre><code>{\n  \"title\": \"my_app_1\",\n  \"retry\": true,\n  \"timeout\": 10\n}\n</code></pre> <p>app_config/config2.yaml</p> <pre><code>title: my_yaml_app\nport: 3030\n</code></pre> <pre><code>from confident import BaseConfig\n\n\nclass MyConfig(BaseConfig):\n    title: str\n    port: int = 5000\n    retry: bool = False\n\nconfig = MyConfig.from_files(['app_config/config1.json', 'app_config/config2.yaml'])\n\nprint(config)\n\n#&gt; title='my_app_1' port=3030 retry=True\n</code></pre> <p>You can also use <code>from_sources</code> to combine files with other sources in a single call:</p> <pre><code>config = MyConfig.from_sources(\n    files=['app_config/config1.json', 'app_config/config2.yaml'],\n    config_map='app/configs.json',\n)\n</code></pre>"},{"location":"validation/","title":"Validation","text":"<p>In order to avoid misconfigurations, Confident will supply indicative errors in case of wrong values or wrong sequence of arguments. For instance:</p> <ul> <li>Wrong or missing files provided.</li> <li>Inserting both <code>map_name</code> and <code>map_field</code> (causing ambiguous config map selection).</li> <li>Wrong types or missing values (by pydantic's validation mechanism).</li> </ul>"},{"location":"visibility/","title":"Visibility","text":"<p>Confident provides built-in functions to show details about the object after creation. The details can be logged/printed and provide clarity about the source of every value in the object.</p>"},{"location":"visibility/#multiple-sources-recognition","title":"Multiple Sources Recognition","text":"<p>In order to monitor which fields were loaded from what source, <code>full_fields()</code> can be used. Notice the difference between the source types:</p> <pre><code>import os\nfrom typing import List\n\nfrom confident import BaseConfig\nfrom confident.config_dict import ConfidentConfigDict\n\nclass AppConfig(BaseConfig):\n    model_config = ConfidentConfigDict(\n        files=['config.yaml'],\n    )\n\n    title: str = 'my_application'\n    timeout: int\n    input_paths: List[str]\n\nos.environ['input_paths'] = '[\"/tmp/input_a\", \"/tmp/input_b\"]'\n\nconfig = AppConfig()\n\nprint(config.full_fields())\n#&gt; {\n# 'title': ConfigField(name='title', value='my_application', origin_value='my_application', source_name='AppConfig', source_type='class_default', source_location=WindowsPath('example.py')),\n# 'timeout': ConfigField(name='timeout', value=60, origin_value=60, source_name='config.yaml', source_type='file', source_location=WindowsPath('config.yaml')),\n# 'input_paths': ConfigField(name='input_paths', value=['/tmp/input_a', '/tmp/input_b'], origin_value='[\"/tmp/input_a\", \"/tmp/input_b\"]', source_name='input_paths', source_type='env_var', source_location='input_paths'),\n# }\n</code></pre>"},{"location":"visibility/#baseconfig-object-source-priority","title":"BaseConfig Object Source Priority","text":"<p>The list of sources to load into the object, from the highest priority to the lowest:</p> <pre><code>config.__source_priority__\n\n#&gt; ['init', 'env_var', 'map', 'file', 'class_default']\n</code></pre>"},{"location":"visibility/#baseconfig-object-creation-location","title":"BaseConfig Object Creation Location","text":"<p>The position of the <code>BaseConfig</code> class declaration:</p> <pre><code>config.__specs__.class_path\n\n#&gt; PosixPath('~/MyProject/project_config.py')\n</code></pre> <p>The position of the <code>BaseConfig</code> object instance creation:</p> <pre><code>config.__specs__.creation_path\n\n#&gt; PosixPath('~/MyProject/main.py')\n</code></pre>"}]}